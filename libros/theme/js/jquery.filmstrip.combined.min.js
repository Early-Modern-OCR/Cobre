/* 
 * <script type="text/javascript" src="/theme/js/jquery.scrollTo-1.4.2.js"></script>
 * <script type="text/javascript" src="/theme/js/jquery.serialScroll.js"></script>
 * <script type="text/javascript" src="/theme/js/jquery.mousewheel.js"></script>
 * <script type="text/javascript" src="/theme/js/jquery.filmstrip.js"></script>
 */

(function(b){function t(e){return typeof e=="object"?e:{top:e,left:e}}var r=b.scrollTo=function(e,j,f){b(window).scrollTo(e,j,f)};r.defaults={axis:"xy",duration:parseFloat(b.fn.jquery)>=1.3?0:1};r.window=function(){return b(window)._scrollable()};b.fn._scrollable=function(){return this.map(function(){if(!(!this.nodeName||b.inArray(this.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1))return this;var e=(this.contentWindow||this).document||this.ownerDocument||this;return b.browser.safari||
e.compatMode=="BackCompat"?e.body:e.documentElement})};b.fn.scrollTo=function(e,j,f){if(typeof j=="object"){f=j;j=0}if(typeof f=="function")f={onAfter:f};if(e=="max")e=9E9;f=b.extend({},r.defaults,f);j=j||f.speed||f.duration;f.queue=f.queue&&f.axis.length>1;if(f.queue)j/=2;f.offset=t(f.offset);f.over=t(f.over);return this._scrollable().each(function(){function s(l){k.animate(a,j,f.easing,l&&function(){l.call(this,e,f)})}var h=this,k=b(h),m=e,p,a={},d=k.is("html,body");switch(typeof m){case "number":case "string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(m)){m=
t(m);break}m=b(m,this);case "object":if(m.is||m.style)p=(m=b(m)).offset()}b.each(f.axis.split(""),function(l,i){var n=i=="x"?"Left":"Top",g=n.toLowerCase(),c="scroll"+n,o=h[c],q=r.max(h,i);if(p){a[c]=p[g]+(d?0:o-k.offset()[g]);if(f.margin){a[c]-=parseInt(m.css("margin"+n))||0;a[c]-=parseInt(m.css("border"+n+"Width"))||0}a[c]+=f.offset[g]||0;if(f.over[g])a[c]+=m[i=="x"?"width":"height"]()*f.over[g]}else{n=m[g];a[c]=n.slice&&n.slice(-1)=="%"?parseFloat(n)/100*q:n}if(/^\d+$/.test(a[c]))a[c]=a[c]<=0?
0:Math.min(a[c],q);if(!l&&f.queue){o!=a[c]&&s(f.onAfterFirst);delete a[c]}});s(f.onAfter)}).end()};r.max=function(e,j){var f=j=="x"?"Width":"Height",s="scroll"+f;if(!b(e).is("html,body"))return e[s]-b(e)[f.toLowerCase()]();f="client"+f;var h=e.ownerDocument.documentElement,k=e.ownerDocument.body;return Math.max(h[s],k[s])-Math.min(h[f],k[f])}})(jQuery);(function(b){var t=b.serialScroll=function(e){return b(window).serialScroll(e)};t.defaults={duration:1E3,axis:"x",event:"click",step:1,lock:true,cycle:true,constant:true,autostart:false};var r={init:function(e){return this.each(function(){var j=b.extend({},t.defaults,e),f=b(j.target||this,j.target?this:document),s=f[0];if(typeof f.data("serialScroll")=="undefined"){var h={settings:j,active:0,context:s,container:f,timer:null,items:null,bound:false,auto:false};if(j.autostart){h.auto=true;if(typeof j.start==
"undefined"||j.start!==null)j.start=0}f.data("serialScroll",h);f.bind("goto.serialScroll",function(k,m){k.preventDefault();var p,a=h.settings.duration;if(typeof m!="number")if(typeof k.data=="number")m=k.data;else throw"jump called with no target index";var d=f.serialScroll("items");if(typeof h.settings.exclude=="number")d=d.slice(0,-h.settings.exclude);p=d[m];var l=d.length;if(!p){p=m<0?0:l-1;if(h.active!=p)m=p;else if(h.settings.cycle)m=l-p-1;else{h.auto&&f.trigger("stop.serialScroll");return}p=
d[m]}if(h.auto&&h.settings.interval){h.timer&&clearTimeout(h.timer);h.timer=setTimeout(function(){f.trigger("next")},h.settings.interval)}if(!(!p||h.settings.lock&&f.is(":animated")||k&&h.settings.onBefore&&h.settings.onBefore(k,p,f,f.serialScroll("items"),m)===false)){d=b.Event("onbefore.serialScroll");f.trigger(d,[k,p,m]);if(!d.isDefaultPrevented()){h.settings.stop&&f.queue("fx",[]).stop();if(h.settings.constant)a=Math.abs(a/h.settings.step*(h.active-m));f.scrollTo(p,a,h.settings);f.trigger("notify.serialScroll",
[m])}}});f.bind("move.serialScroll",function(k,m){if(typeof m!="number"){if(typeof k.data!="number")throw"move triggered with no delta specified";m=k.data}k.type="goto.serialScroll";return b(this).trigger(k,[m+h.active])});f.bind("prev.serialScroll",function(k){if(typeof k!="undefined"){k.type="move.serialScroll";return b(this).trigger(k,[-h.settings.step])}else return b(this).trigger("move.serialScroll",[-h.settings.step])});f.bind("next.serialScroll",function(k){if(typeof k!="undefined"){k.type=
"move.serialScroll";return b(this).trigger(k,[h.settings.step])}else return b(this).trigger("move.serialScroll",[h.settings.step])});f.bind("start.serialScroll",function(){if(typeof h.settings.interval=="undefined")throw"An interval must be set before starting auto scrolling";if(!h.auto&&h.settings.interval){if(h.timer){clearTimeout(h.timer);h.timer=null}h.auto=true;b(this).trigger("next")}return this});f.bind("stop.serialScroll",function(){if(h.timer){clearTimeout(h.timer);h.timer=null}h.auto=false;
return this});f.bind("notify.serialScroll",function(k,m){if(typeof m=="undefined"){if(typeof k.data=="undefined")throw"notify triggered with no target element specified";m=k.data}m=f.serialScroll("index",m);if(m>-1)h.active=m;return this});typeof j.start!="undefined"&&j.start!==null&&f.trigger("goto",j.start);typeof j.prev!="undefined"&&f.find(j.prev).bind(j.event,function(k){k.preventDefault();f.trigger("prev.serialScroll")});typeof j.next!="undefined"&&f.find(j.next).bind(j.event,function(k){k.preventDefault();
f.trigger("next.serialScroll")})}})},data:function(){if(typeof this.data("serialScroll")=="undefined")throw"serialScroll has not been initialized yet";return this.data("serialScroll")},current:function(){return this.serialScroll("data").active},interval:function(e){if(typeof e=="number")b(this).serialScroll("data").settings.interval=e;return b(this).serialScroll("data").settings.interval},jump:function(e){this.trigger("goto.serialScroll",e)},items:function(e){var j=this.serialScroll("data");if(typeof e==
"string"){j.settings.items=e;j.items=j.settings.lazy?null:b(e,j.context)}if(j.items)return j.items;return b(j.settings.items,j.context)},index:function(e){if(typeof e=="number")return e;for(var j,f=this.serialScroll("data"),s=this.serialScroll("items");(j=s.index(e))==-1&&e!=f.context;)e=e.parentNode;return j},notify:function(e){return this.trigger("notify.serialScroll",e)},move:function(e){return this.trigger("move.serialScroll",[e])},next:function(){return this.trigger("next.serialScroll")},previous:function(){return this.trigger("prev.serialScroll")},
start:function(){return this.trigger("start.serialScroll")},stop:function(){return this.trigger("stop.serialScroll")}};b.fn.serialScroll=function(e){if(r[e])return r[e].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e)return r.init.apply(this,arguments);else b.error("Method "+e+" does not exist on jQuery.serialScroll")}})(jQuery);(function(b){function t(e){var j=e||window.event,f=[].slice.call(arguments,1),s=0,h=0,k=0;e=b.event.fix(j);e.type="mousewheel";if(e.wheelDelta)s=e.wheelDelta/120;if(e.detail)s=-e.detail/3;k=s;if(j.axis!==undefined&&j.axis===j.HORIZONTAL_AXIS){k=0;h=-1*s}if(j.wheelDeltaY!==undefined)k=j.wheelDeltaY/120;if(j.wheelDeltaX!==undefined)h=-1*j.wheelDeltaX/120;f.unshift(e,s,h,k);return b.event.handle.apply(this,f)}var r=["DOMMouseScroll","mousewheel"];b.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=
r.length;e;)this.addEventListener(r[--e],t,false);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=r.length;e;)this.removeEventListener(r[--e],t,false);else this.onmousewheel=null}};b.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})})(jQuery);(function(b){var t=function(a,d,l,i){a=b(this);if(!d.relatedTarget&&a.filmstrip("data").locked){d=a.parent().siblings("div.filmstripWrapper").find("div.filmstrip");var n=i-a.serialScroll("current"),g=this;d.each(function(){var c=b.Event("move.serialScroll");c.relatedTarget=g;b(this).trigger(c,n)})}},r=function(a){a.preventDefault();b(this).parent().filmstrip("lock")},e=function(a){a.preventDefault();b(this).parent().filmstrip("unlock")},j=function(){var a=b(this),d=a.find("a.lockable");a.removeClass("locked");
a.addClass("unlocked");d.unbind("click",e);d.bind("click",r);d.removeClass("unlock");d.addClass("lock");d.text("Lock");d.attr("title","Lock the filmstrips")},f=function(){var a=b(this),d=a.find("a.lockable");a.removeClass("unlocked");a.addClass("locked");d.unbind("click",r);d.bind("click",e);d.removeClass("lock");d.addClass("unlock");d.text("Unlock");d.attr("title","Unlock the filmstrips")},s=function(){var a=b(this),d=a.find(".filmstripWrapper > div.filmstrip"),l=0;for(l=0;l<d.length;l++)b(d[l]).filmstrip("data").locked=
true;a.trigger("locked.filmstrip")},h=function(){var a=b(this),d=a.find(".filmstripWrapper > div.filmstrip"),l=0;for(l=0;l<d.length;l++)b(d[l]).filmstrip("data").locked=false;a.trigger("unlocked.filmstrip")},k=function(a){a.preventDefault();a=b(this);a.unbind("click",k);a.bind("click",m);a.parents("div.filmstripWrapper").find("div.filmstrip").filmstrip("start")},m=function(a){a.preventDefault();a=b(this);a.unbind("click",m);a.bind("click",k);a.parents("div.filmstripWrapper").find("div.filmstrip").filmstrip("stop")},
p={init:function(a){var d={buttons:true,slider:true,mousewheel:true,global:true,lockable:true,slideshow:true,synchronizable:true,scrollSettings:{},offset:1,autoExclude:true,locked:false,statusDisplay:true,sizeClass:null,sizeSelection:true,sizeOptions:[{klass:"small",title:"Small"},{klass:"medium",title:"Medium"},{klass:"large",title:"Large"}]},l={items:"li",jump:false,autostart:false,lock:false,stop:true,force:false,cycle:false,duration:10,interval:1E3,easing:"swing"};if(this.length==0)return this;
this.addClass("filmstrip");if(this.length==1)d.global=false;if(typeof a=="object"){b.extend(d,a);typeof a.serialScroll=="object"&&b.extend(l,a.serialScroll)}if(d.global){this.wrapAll('<div class="filmstripsWrapper" />');var i=this.parent();i.append('<div class="globalFilmstripControls" />');d.sizeClass&&i.addClass(d.sizeClass)}this.wrap('<div class="filmstripWrapper"><div class="filmstrip" /></div>');this.parent().data("filmstrip",{settings:d,scrollSettings:l});this.parent().after('<div class="filmstripControls" />');
if(d.sizeClass){this.parent().addClass(d.sizeClass);this.parents(".filmstripWrapper").addClass(d.sizeClass)}if(d.buttons){this.parents(".filmstripWrapper").prepend('<a href="#" class="prev">&nbsp;</a><a href="#" class="next">&nbsp;</a>');this.parents(".filmstripWrapper").find("a.prev").click(function(){b(this).siblings(".filmstrip").trigger("prev.serialScroll");return false});this.parents(".filmstripWrapper").find("a.next").click(function(){b(this).siblings(".filmstrip").trigger("next.serialScroll");
return false})}if(d.slider){this.parent().bind("onbefore.serialScroll",function(g,c,o,q){b(this).parent().find(".slider").slider("value",q);return true});this.each(function(g,c){c=b(c);var o=b('<div class="slider" />');c.parents(".filmstripWrapper").find(".filmstripControls").prepend(o);o.after('<div class="clear" />');var q=c.children().length-1;if(typeof l.exclude=="number")q-=l.exclude;o.slider({max:q,slide:function(u,v){b(this).parents(".filmstripWrapper").find("div.filmstrip").trigger("goto",
[v.value])}})});if(typeof i!="undefined"){i.bind("locked.filmstrip",function(){var g=b(this),c=-1,o=-1,q,u=g.find(".filmstripWrapper > div.filmstrip");o=null;if(u.length<2)return false;for(q=0;q<u.length;q++){o=b(u[q]);o=o.serialScroll("current");if(c>-1&&o!=c)return false;else if(c==-1)c=o}g.find(".filmstripWrapper .slider:not(:last)").hide()});i.bind("unlocked.filmstrip",function(){b(this).find(".filmstripWrapper .slider").show()})}}if(d.sizeSelection){a="";for(var n=0;n<d.sizeOptions.length;n++)a+=
'<a href="#'+d.sizeOptions[n].klass+'" \t\t\t\t\t\tclass="resizer '+d.sizeOptions[n].klass+'" \t\t\t\t\t\ttitle="Change size to '+d.sizeOptions[n].title+'"\t\t\t\t\t\t>'+d.sizeOptions[n].title+"</a>";d.global?i.find(".globalFilmstripControls").append(a):this.parents(".filmstripWrapper").find(".filmstripControls").append(a);b(".filmstripControls .resizer, .globalFilmstripControls .resizer").live("click",function(g){g.preventDefault();b(this).parent().parent().find("div.filmstrip").filmstrip("resize",
b(this).attr("href").substring(1))})}d.mousewheel&&this.mousewheel(function(g,c){g.preventDefault();if(c>0)b(this).trigger("prev.serialScroll");else c<0&&b(this).trigger("next.serialScroll")});this.parent().serialScroll(l);this.parent().filmstrip("resize");if(d.global&&d.lockable){i.find(".globalFilmstripControls").append('<a href="#" class="lock lockable" title="Lock the filmstrips">Lock</a>');i.find(".lock").bind("click",r);this.bind("lock.filmstrip",function(){i.trigger("lock.filmstrip")});this.bind("unlock.filmstrip",
function(){i.trigger("unlock.filmstrip")});this.parent().bind("lock.filmstrip",function(){i.trigger("lock.filmstrip")});this.parent().bind("unlock.filmstrip",function(){i.trigger("unlock.filmstrip")});i.bind("lock.filmstrip",s);i.bind("unlock.filmstrip",h);i.bind("locked.filmstrip",f);i.bind("unlocked.filmstrip",j);this.parent().bind("onbefore.serialScroll",t)}if(d.global&&d.synchronizable){a=this.parents(".filmstripWrapper").find(".filmstripControls");a.append('<a href="#" class="synchronize" title="Synchronize to this filmstrip">Synchronize to this filmstrip</a>');
a.find(".synchronize").click(function(g){g.preventDefault();var c=b(this).parents("div.filmstripWrapper");g=c.find("div.filmstrip");c=c.siblings("div.filmstripWrapper").find("div.filmstrip");var o=g.serialScroll("current");c.each(function(q,u){b(u).serialScroll("jump",o)})});i.bind("locked.filmstrip",function(){b(this).find(".synchronize").hide()});i.bind("unlocked.filmstrip",function(){b(this).find(".synchronize").show()})}if(d.slideshow){a=this.parents(".filmstripWrapper").find(".filmstripControls");
if(l.autostart){a.append('<a href="#" class="slideshowControl stop">Stop</a>');a.find(".slideshowControl").bind("click",m)}else{a.append('<a href="#" class="slideshowControl start">Start</a>');a.find(".slideshowControl").bind("click",k)}a.append('<div class="slideshowSpeedControl"><select><option value="4000">0.25x</option><option value="2000">0.5x</option><option value="1000" selected="true">1x</option><option value="500">2x</option><option value="250">4x</option><option value="125">8x</option></select></div>');
a.find(".slideshowSpeedControl select").bind("change",function(){var g=b(this).parents(".filmstripWrapper").find("div.filmstrip"),c=g.parents(".filmstripsWrapper");c.length==1&&g.filmstrip("data").locked?c.find("div.filmstrip").filmstrip("interval",parseInt(this.value)):g.filmstrip("interval",parseInt(this.value))});this.parent().bind("stop.filmstrip",function(){var g=b(this),c=g.serialScroll("data");g.parent().removeClass("running");g.parent().addClass("stopped");g.parent().find(".slideshowControl").removeClass("stop");
g.parent().find(".slideshowControl").addClass("start");g.parent().find(".slideshowControl").text("Start");if(typeof c.originalDuration!="undefined"&&c.originalDuration!=null){c.settings.duration=c.originalDuration;c.originalDuration=null}if(typeof c.originalEasing!="undefined"&&c.originalEasing!=null){c.settings.easing=c.originalEasing;c.originalEasing=null}g.trigger("stop.serialScroll")});this.parent().bind("start.filmstrip",function(){var g=b(this),c=g.serialScroll("data");g.parent().removeClass("stopped");
g.parent().addClass("running");g.parent().find(".slideshowControl").removeClass("start");g.parent().find(".slideshowControl").addClass("stop");g.parent().find(".slideshowControl").text("Stop");if(typeof c.settings.easing=="undefined")c.settings.easing="swing";if(typeof c.originalDuration=="undefined"||c.originalDuration==null){c.originalDuration=c.settings.duration;c.originalEasing=c.settings.easing}c.settings.duration=c.settings.interval;c.settings.easing="linear";g.trigger("start.serialScroll")});
if(typeof i!="undefined"){i.bind("locked.filmstrip",function(){var g=b(this),c=g.find("div.filmstrip:not(:last)");g=g.find("div.filmstrip:last");var o=g.filmstrip("interval");b(this).find(".filmstripControls:not(:last)").hide();g.trigger("stop.filmstrip");c.each(function(q,u){b(u).filmstrip("interval",o)})});i.bind("unlocked.filmstrip",function(){var g=b(this);g.find(".filmstripControls").show();g.find("div.filmstrip").trigger("stop.filmstrip");g.find(".filmstripControls .slideshowSpeedControl select").trigger("change")});
i.find("div.filmstrip:last").bind("start.filmstrip",{container:i},function(g){var c=b(this);g=g.data.container.find("div.filmstrip:not(:last)");c.filmstrip("data").locked&&g.trigger("start.filmstrip")});i.find("div.filmstrip:last").bind("stop.filmstrip",{container:i},function(g){var c=b(this);g=g.data.container.find("div.filmstrip").not(":last");c.filmstrip("data").locked&&g.each(function(o,q){b(q).trigger("stop.filmstrip")})})}}if(d.statusDisplay){this.each(function(g,c){c=b(c).parent();var o=b('<div class="display"> </div>');
c.parents(".filmstripWrapper").find(".filmstripControls").append(o);c.parents(".filmstripWrapper").find(".display").html("Page 0-"+(c.filmstrip("numberOfItemsVisible")-1)+" of "+c.serialScroll("items").length)});this.parent().bind("onbefore.serialScroll",function(g,c,o,q){b(this).parent().find(".display").html("Page "+q+"-"+(q+b(this).filmstrip("numberOfItemsVisible")-1)+" of "+b(this).serialScroll("items").length);return true})}return this},lock:function(){return this.trigger("lock.filmstrip")},
unlock:function(){return this.trigger("unlock.filmstrip")},start:function(){return this.trigger("start.filmstrip")},stop:function(){return this.trigger("stop.filmstrip")},interval:function(a){var d=this.serialScroll("data");if(typeof d.originalDuration=="number"&&typeof a=="number"){d.settings.interval=a;d.settings.duration=a;return this}return this.serialScroll("interval",a)},data:function(){return this.data("filmstrip")},resize:function(a){this.trigger("onBeforeResize.filmstrip",[a]);if(typeof a!=
"undefined"){for(var d=0;d<this.length;d++){var l=b(this[d]),i=l.filmstrip("data").settings.sizeClass;if(typeof i!="undefined"&&i!=null&&i!=a){l.removeClass(i);l.parents(".filmstripWrapper,.filmstripsWrapper").removeClass(i)}}this.addClass(a);this.parents(".filmstripWrapper,.filmstripsWrapper").addClass(a);for(d=0;d<this.length;d++)b(this[d]).filmstrip("data").settings.sizeClass=a}for(d=0;d<this.length;d++){l=b(this[d]);var n=l.filmstrip("data").settings;a=l.serialScroll("data").settings;i=l.serialScroll("items");
for(var g=400,c=0;c<i.length;c++)g+=b(i[c]).outerWidth(true);b(l.children()[0]).width(g);if(typeof n.offset=="number"&&n.offset>0)for(c=a.offset=0;c<n.offset&&c<i.length;c++)a.offset-=b(i[c]).outerWidth(true);if(n.autoExclude&&i.length>0){g=b(i[0]).outerWidth(true);c=l.parent().innerWidth();if(typeof a.offset=="number")c+=a.offset;a.exclude=Math.floor(c/g)-2}if(n.slider){n=l.parents("div.filmstripWrapper").find("div.slider");i=i.length;if(typeof a.exclude=="number")i-=a.exclude;n.slider("option",
"max",i)}l.serialScroll("jump",l.serialScroll("current"))}return this},numberOfItemsVisible:function(){if(this.length>1)return 0;for(var a=this.serialScroll("items"),d=0,l=this.innerWidth(),i=this.serialScroll("current");i<a.length&&l>0;i++){l-=b(a[i]).outerWidth(true);d++}return d}};b.fn.filmstrip=function(a){if(a!="init"&&p[a]){var d=this.is("div.filmstrip")?this:this.is("div.filmstripsWrapper,div.filmstripWrapper")?this.find("div.filmstrip"):this.parents("div.filmstrip").length>0?this.parents("div.filmstrip"):
this;return p[a].apply(d,Array.prototype.slice.call(arguments,1))}else if(typeof a==="object"||!a)return p.init.apply(this,arguments);else b.error("Method "+a+" does not exist on jQuery.filmstrip")}})(jQuery);
